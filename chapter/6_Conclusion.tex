%%%%%%%%%%%%%%%%%%%%%%%% Conclusion %%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Conclusion}
% diff txt rep
\paragraph{Alternative Textual Representations}
By conceptually altering the existing Parse Tree Constructor of Xtext, different textual representations are possible. The possibly ambiguous mapping from model to Parse Tree is leveraged to allow different, context free grammar conform representations. For a user, a high degree of ambiguity is desirable, because it provides them with a higher variety of semantically equivalent representations. The extension of the Parse Tree Constructor requires the calculation of all valid solutions instead of one valid solution. Considering that the current Parse Tree Constructor uses Backtracking, it is not suited for a high degree of ambiguity. Plain Backtracking does not scale into calculating all solutions, especially regarding the combinatorial explosion of alternative combined list elements; for practical use an improved algorithm is required. The alternative textual representations are different Parse Trees, thus the representations do not just alter token values, but also \emph{alter the structure}. This can be leveraged during grammar design time to avoid manual model transformations. 

\paragraph{Structured Characters}
The use of EMF Lexers Structured Characters enables \code{EObject}s on the character stream \emph{as Terminals}. This eases the constraint that the grammar must \emph{describe} all model elements, but still requires that their occurrence is \emph{declared} in it. This allows the user to textually change or create those Structured Terminals, so if the model should ever be editable outside a Structured Character aware editor, their use is discouraged. Unhandled Structured Characters are not usable, because they are a ``black'' box ($\square$) from the user's perspective.

\paragraph{Sentential Character based Graphical Editors}
Sentential forms of the Parse Tree can be persisted and used instead of the original input, \cite{iSW}. Post processing of the grammar to contain Structured Characters instead of non-terminals allows the use of sentential forms on the character stream, but results in large Parse Tables. A sentential node is the root of the persisted subtree and represents a production part in the grammar. In conjunction with the corresponding language model elements, the Parse Tree Constructor can produce a valid sentential form at any time, which makes actual parse subtree construction for sentential characters obsolete. The Sentential Character is valid if the corresponding language model elements conform to the constraints of its production part.  While displaying the character stream, a graphical editor can substitute the Sentential Character and operate on its model elements as long as changes keep the model elements in a state that conforms to the production part constraints. This procedure allows the integration of graphical editors into texts which still \emph{conform to a context free grammar}. During context free grammar definition time, it is not required to consider the existence of graphical editors. Graphical editors can substitute \emph{any} symbol and \code{Sequence}, which enables fine grained editors, but with potential overlapping functionality. To determine a specific graphical editor for a sentential character, the referenced \code{EObject} is specialized by the Parse Tree Constructor. Thus, incremental visual domain specific language development from an internal textual domain specific language is possible. The graphical editor extensions of the language are locked to the editor framework. Because language extensions in general are locked to the language Metamodel, a common Metamodel for a textual language should be shared across the editor framework.


\paragraph{Effect of Unstable Models}
If language model elements are replaced instead of updated for textual changes, the language model is called \emph{unstable}. Referential integrity for existing references or URI based references can not be kept. Parsing technique used by the EMF related textual editing tools like EMFText, Xtext and Textual Editing Framework results in unstable models, therefore the effect of unstable models to the presented solutions is important. 
\begin{itemize}
	\item The Notation model has to be rebuilt on every textual update. Thus, every information which can not be derived from the textual representation is lost.
	\item References of \code{EObject}s in Structured Characters that reference \code{EObject}s which might get updated due to textual changes are unstable. This can be circumvented by erasing the reference and storing a textual identification in an \code{Annotation} to resolve the reference like any textual reference. Changes to the identification of the referenced target, must be taken over by the editor to the textual identification in the \code{Annotation}.
	\item Sentential Characters must be handled, because Parse Tree construction was omitted due to the existence of the Parse Tree Constructor and the referencing \code{EObject}. To avoid merging of old and new versions of the language model by using the Notation model, a containment reference instead of a cross reference from the \code{EObjectProduction} to the referenced language \code{EObject} is used. Notation model elements depend on the data of their containing \code{EObjectProduction}, if they are none themselves. Therefore, Sentential Characters are restricted to \code{EObjectProduction}, or to parts of the attributed grammar that produce or refer to an \code{EObject} themselves. 
\end{itemize}

\paragraph{EMF based Textual Frameworks}
At the current state EMF based textual frameworks produce only unstable models. Thus cross-references created by graphical editors must be \emph{manually maintained each time the textual representation is changed}. This work is error prone and not maintainable for large, frequently changing models. Where no intrinsic identification of language elements exist in the language, manually set cross references are unusable. Cross references are one of the key advantages of languages defined by Metamodels over context free grammars. The problem of unstable models is caused by the use of certain existing Parser generators like ANTLR for Xtext and EMFText and RunCC \footnote{\raggedright \url{http://runcc.sourceforge.net/}} for TEF. These Parser generators are designed to support the creation of a language based on a context free grammar.
Without cross references, two equal Parse Trees are interchangeable. In practice, created references like symbol tables, are automatically derived from the textual representation which solely describe the abstract syntax tree, so the problem does not become eminent. However, parser technologies were developed that optimally reuse existing parse trees to avoid CPU intensive post processing. Reusing the Parse Tree allows manually set cross-references. The choice of existing EMF based textual frameworks to use non-incremental Parsers for EMF integration instead of incremental Parsers like \cite{xglr} should be reconsidered.

Despite the problem of unstable models, alternative graphical representations by grammar conform Sentential Characters remain feasible, making graphical internal domain specific languages possible. 
$\square$
